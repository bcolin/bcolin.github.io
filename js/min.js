// @preserve Author: Benoit Colin - @license BY-NC 4.0
var ctrl=null,t="",a={back:function(){2<=window.history.length&&window.history.back()},onhashchange:function(){var e=location.hash.replace("#","");e!=t&&ctrl&&ctrl.dispose(),""==e||"home"==e?(t="home",(ctrl=n).start()):"contact"==e?(t="contact",(ctrl=r).start()):"burger"==e&&(t="burger",(ctrl=i).start())}};window.onhashchange=a.onhashchange;var n={start:function(){},dispose:function(){}},r={start:function(){var e;m.pause(),(e=document.getElementById("backlayer").style).opacity=1,e.pointerEvents="all",(e=document.getElementById("contactme").style).opacity=1,e.pointerEvents="all",e.transform="",o.remove(),this.isAnimPlayed||(this.isAnimPlayed=!0,this.c1anim=new s(document.getElementById("c1"),"bntcolin@gmail.com",function(e){document.getElementById("c1link").href="mailto:"+e}),this.c2anim=new s(document.getElementById("c2"),"06 84 07 12 45",function(e){document.getElementById("c2link").href="tel:"+e}))},onBackClick:function(e){e.stopPropagation(),a.back()},dispose:function(){var e;m.resume(),(e=document.getElementById("backlayer").style).opacity=0,e.pointerEvents="none",(e=document.getElementById("contactme").style).opacity=0,e.pointerEvents="none",e.transform="translateY(-100px) scale(.5,.5)"}},i={start:function(){m.pause();var e=document.getElementById("menu").style;e.opacity=1,e.pointerEvents="all",e.transform="",o.remove()},onBackClick:function(e){e.stopPropagation(),a.back()},dispose:function(){m.resume();var e=document.getElementById("menu").style;e.opacity=0,e.pointerEvents="none",e.transform="translateX(-100%)"}},o={isRemoved:!1,remove:function(){if(!this.isRemoved){this.isRemoved=!0;var e=document.getElementById("hider");e&&(e.style.opacity=0,setTimeout(function(){e.parentElement.removeChild(e)},1550))}}};function s(e,t,a){this.elm=e,this.elm.className="shuffled",this.finaltext=t,this.text="",this.cb=a,this.blurbs="x$(_!-##}{*~):ยง8/][?XYZHWZUM",this.perms=[];for(var n=0;n<this.finaltext.length;n++)this.perms.push(Math.floor(2+4*Math.random())),this.text+=this.blurbs[Math.floor(Math.random()*this.blurbs.length)];this.count=0;var r=this;this.interval=setInterval(function(){r.anim()},20)}function e(e,t,a){return e.substr(0,t)+a+e.substr(t+a.length)}document.addEventListener("DOMContentLoaded",function(){location.hash&&(location.hash=""),t="home",(ctrl=n).start(),m.start(function(){o.remove()})}),s.prototype.anim=function(){Math.floor(Math.random()*this.finaltext.length);this.count>=this.perms.length&&(this.count=0),0<this.perms[this.count]?(this.perms[this.count]--,this.text=e(this.text,this.count,this.blurbs[Math.floor(Math.random()*this.blurbs.length)])):this.text=e(this.text,this.count,this.finaltext[this.count]),this.count++,this.elm.innerHTML=this.text,(100<this.count||this.text==this.finaltext)&&(this.text=this.finaltext,clearInterval(this.interval),this.elm.className="",this.cb(this.text))};var m={time:0,timeMax:.06,start:function(d){var l=this;l.renderer||(m.time=0,l.renderer||(l.clock=new THREE.Clock,l.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),l.renderer.setPixelRatio(1),l.renderer.setSize(window.innerWidth,window.innerHeight),l.renderer.shadowMap.type=THREE.PCFShadowMap,l.renderer.shadowMap.enabled=!0,l.renderer.shadowMap.renderReverseSided=!1,l.domElement=document.getElementById("scene"),l.domElement.appendChild(l.renderer.domElement),l.scene=new THREE.Scene,l.aspect=window.innerWidth/window.innerHeight,l.angle=0,l.meshes=[],l.plateauMesh=new THREE.Object3D,(new THREE.JSONLoader).load("scene/arraow.json",function(e){var t=new THREE.MeshLambertMaterial({color:13097471}),a=null;l.lookMeshes=[];for(var n=0;n<10;n++){var r=new THREE.Mesh(e,t);r.castShadow=!0;var i=r,o=Math.random()<.5?-1:1;i.userData.rotspeed=o*(.3+.6*Math.random()),i.userData.intersectTime=.5*Math.random(),i.userData.intersectTimeMax=.25,i.userData.vy=0,i.userData.dirTime=2+1.5*Math.random(),i.userData.dirTimeMax=0==n?9:.5,i.userData.vel=new THREE.Vector3(0,0,0),i.userData.acc=new THREE.Vector3(0,0,0),i.userData.targetQuaternion=new THREE.Quaternion,i.userData.speed=.11+.005*Math.pow(n,1.34),i.userData.scale=1.25-.1*n,i.userData.rotobj=new THREE.Object3D,i.userData.rotobjtarget=new THREE.Object3D,i.scale.set(i.userData.scale,i.userData.scale,i.userData.scale),a&&(i.userData.targetMesh=a),n<3&&l.lookMeshes.push(r),r.rotation.order="YXZ",r.position.set(60*Math.random()-30,-.5,60*Math.random()-30),l.meshes.push(r),l.scene.add(r),a=r}l.scene.add(new THREE.AmbientLight(16777215,.8)),l.light=new THREE.PointLight(16777215,.4),l.light.position.set(18,18,-48),l.light.castShadow=!0,l.light.shadow.mapSize.width=1024,l.light.shadow.mapSize.height=1024,l.light.shadow.camera.near=.01,l.light.shadow.camera.far=1e3;l.light.shadow.camera.left=-1,l.light.shadow.camera.right=1,l.light.shadow.camera.top=1,l.light.shadow.camera.bottom=-1,l.light.shadow.radius=4,l.scene.add(l.light),l.hm=[];var s=new THREE.PlaneGeometry(140,140,6,15);s.rotateX(-Math.PI/2),s.vertices.forEach(function(e,t){e.y=1.2*Math.sin(.6*e.x+.9*e.z)+1.9*Math.cos(.1*e.x+Math.sin(.5*e.z)),65<Math.abs(e.x)&&(e.x+=50*Math.sign(e.x)),45<Math.abs(e.x)&&(e.y+=.08*Math.abs(e.x)-3)}),s.computeFaceNormals(),l.planemesh=new THREE.Mesh(s,new THREE.MeshLambertMaterial({color:6194943})),l.planemesh.receiveShadow=!0,l.scene.add(l.planemesh),l.camera=new THREE.PerspectiveCamera(45,l.aspect,.25,300),l.scene.add(l.camera),l.lookpoint=new THREE.Vector3(0,3.5,-20),l.renderer.render(l.scene,l.camera);var c=new THREE.Vector3(0,0,0),h=new THREE.Vector3(0,-1,0);l.raycaster=new THREE.Raycaster(c,h),l.upvector=new THREE.Vector3(0,1,0),window.onresize=function(){l.renderer.setSize(window.innerWidth,window.innerHeight),l.aspect=window.innerWidth/window.innerHeight,l.camera.aspect=l.aspect,l.camera.updateProjectionMatrix()},setTimeout(d,100),requestAnimationFrame(m.updaterender)})))},updaterender:function(){if(m.renderer){var e=Math.min(.3,2*m.clock.getDelta());m.time+=e;m.camera.position.set(0,28,60);for(var t=0;t<m.lookMeshes.length;t++){var a=m.lookMeshes[t];m.lookpoint.x=.35*a.position.x,m.lookpoint.y=14+.15*a.position.y,m.lookpoint.z=.75*a.position.z,m.camera.position.x+=.12*a.position.x,m.camera.position.z+=.12*a.position.z}if(m.camera.lookAt(m.lookpoint),m.time>m.timeMax||0<m.endTime){for(t=m.time=0;t<m.meshes.length;t++){if((a=m.meshes[t]).userData.intersectTime+=e,a.userData.intersectTime>a.userData.intersectTimeMax){a.userData.intersectTime=0,m.raycaster.ray.origin.set(a.position.x,10,a.position.z);var n=m.raycaster.intersectObject(m.planemesh)[0];if(n){var r=n.point.y-a.position.y;a.userData.vel.y=1.5*r,a.userData.acc.y=1*r,a.userData.rotobjtarget.quaternion.setFromUnitVectors(m.upvector,n.face.normal)}}if(a.userData.dirTime+=e,a.userData.dirTime>a.userData.dirTimeMax)if(a.userData.dirTime=0,a.userData.targetMesh)a.userData.acc.copy(a.userData.targetMesh.position).sub(a.position).normalize();else{var i=new THREE.Vector3(60*Math.random()-30,0,60*Math.random()-30);a.userData.acc.copy(i).sub(a.position).normalize()}a.userData.vel.add(a.userData.acc);var o=a.userData.vel.length();32<o&&a.userData.vel.multiplyScalar(32/o),a.position.x+=a.userData.vel.x*e*a.userData.speed,a.position.y+=a.userData.vel.y*e,a.position.z+=a.userData.vel.z*e*a.userData.speed,a.userData.rotobj.quaternion.slerp(a.userData.rotobjtarget.quaternion,3.6*e),a.rotation.order="XZY",a.rotation.copy(a.userData.rotobj.rotation),a.rotation.order="XZY",a.rotation.y=Math.atan2(a.userData.vel.x,a.userData.vel.z)}m.plateauMesh.rotation.y+=.15*e,m.renderer.render(m.scene,m.camera)}m.isStopRequested||requestAnimationFrame(m.updaterender)}},layout:function(){m.renderer&&m.renderer.setSize(window.innerWidth,window.innerHeight),m.camera&&(m.aspect=window.innerWidth/window.innerHeight,m.camera.aspect=m.aspect,m.camera.updateProjectionMatrix())},pause:function(){m.isStopRequested=!0},resume:function(){m.isStopRequested=!1,requestAnimationFrame(m.updaterender)}};